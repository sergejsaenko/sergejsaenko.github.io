import{$ as w,A as ee,Aa as ce,Ba as C,Ca as le,F as te,Fa as ue,Ga as de,H as ne,Ha as fe,J as S,K as ie,L as se,O as T,Q as g,R as p,S as f,T as m,Ta as he,Xa as ge,a as d,b,c as U,f as J,ga as re,i as W,j as Y,ja as oe,jb as I,k as Z,l as E,m as D,q as y,qa as ae,r as Q,v as j,x as X,ya as $}from"./chunk-6SF4GNZM.js";function P(n){n||(n=f(w));let o=new J(e=>{if(n.destroyed){e.next();return}return n.onDestroy(e.next.bind(e))});return e=>e.pipe(ie(o))}function pe(n){return typeof n=="function"}function v(n){return typeof n=="string"}function M(n){return!!n&&typeof n=="object"&&!Array.isArray(n)}function N(n){return n==null}function k(n){return!N(n)}function _(n){return n?Array.isArray(n)||v(n)?n.length:M(n)?Object.keys(n).length:0:0}function ve(n){return _(n)===0}function V(n){return n.replace(/(?:^\w|[A-Z]|\b\w)/g,(o,e)=>e==0?o.toLowerCase():o.toUpperCase()).replace(/\s+|_|-|\//g,"")}var B=class{translations;constructor(o){this.translations=o}getTranslation(o){return D(this.translations.get(o)||{})}},me=new g(""),O=new g("",{providedIn:"root",factory:()=>A}),A={defaultLang:"en",reRenderOnLangChange:!1,prodMode:!1,failedRetries:2,fallbackLang:[],availableLangs:[],missingHandler:{logMissingKey:!0,useFallbackTranslation:!1,allowEmpty:!1},flatten:{aot:!1},interpolation:["{{","}}"],scopes:{keepCasing:!1,autoPrefixKeys:!0}};function xe(n={}){return b(d(d({},A),n),{missingHandler:d(d({},A.missingHandler),n.missingHandler),flatten:d(d({},A.flatten),n.flatten),scopes:d(d({},A.scopes),n.scopes)})}function K(n,o){return n&&(Object.prototype.hasOwnProperty.call(n,o)?n[o]:o.split(".").reduce((e,t)=>e?.[t],n))}function Fe(n,o,e){n=d({},n);let t=o.split("."),i=t.length-1;return t.reduce((s,r,a)=>(a===i?s[r]=e:s[r]=Array.isArray(s[r])?s[r].slice():d({},s[r]),s&&s[r]),n),n}var be=new g(""),Ee=(()=>{class n{config=f(O,{optional:!0})??A;get interpolationMatcher(){return $e(this.config)}transpile({value:e,params:t={},translation:i,key:s}){if(v(e)){let r,a=e;for(;(r=this.interpolationMatcher.exec(a))!==null;){let[l,c]=r;a=a.replace(l,()=>{let u=c.trim(),h=K(t,u);return k(h)?h:k(i[u])?this.transpile({params:t,translation:i,key:s,value:i[u]}):""})}return a}else t&&(M(e)?e=this.handleObject({value:e,params:t,translation:i,key:s}):Array.isArray(e)&&(e=this.handleArray({value:e,params:t,translation:i,key:s})));return e}handleObject({value:e,params:t={},translation:i,key:s}){let r=e;return Object.keys(t).forEach(a=>{let l=this.transpile({value:K(r,a),params:K(t,a),translation:i,key:s});r=Fe(r,a,l)}),r}handleArray(i){var s=i,{value:e}=s,t=U(s,["value"]);return e.map(r=>this.transpile(d({value:r},t)))}static \u0275fac=function(t){return new(t||n)};static \u0275prov=T({token:n,factory:n.\u0275fac})}return n})();function $e(n){let[o,e]=n.interpolation;return new RegExp(`${o}([^${o}${e}]*?)${e}`,"g")}var ye=new g(""),Pe=(()=>{class n{handle(e,t){if(t.missingHandler.logMissingKey&&!t.prodMode){let i=`Missing translation for '${e}'`;console.warn(`%c ${i}`,"font-size: 12px; color: red")}return e}static \u0275fac=function(t){return new(t||n)};static \u0275prov=T({token:n,factory:n.\u0275fac})}return n})(),Se=new g(""),ke=(()=>{class n{preSaveTranslation(e){return e}preSaveTranslationKey(e,t){return t}static \u0275fac=function(t){return new(t||n)};static \u0275prov=T({token:n,factory:n.\u0275fac})}return n})(),Te=new g(""),_e=(()=>{class n{userConfig;constructor(e){this.userConfig=e}getNextLangs(){let e=this.userConfig.fallbackLang;if(!e)throw new Error("When using the default fallback, a fallback language must be provided in the config!");return Array.isArray(e)?e:[e]}static \u0275fac=function(t){return new(t||n)(p(O))};static \u0275prov=T({token:n,factory:n.\u0275fac})}return n})();function Ae(n){let{path:o,inlineLoader:e,mainLoader:t,data:i}=n;if(e){let s=e[o];if(pe(s)===!1)throw`You're using an inline loader but didn't provide a loader for ${o}`;return e[o]().then(r=>r.default?r.default:r)}return t.getTranslation(o,i)}function Ve({mainLoader:n,path:o,data:e,fallbackPath:t,inlineLoader:i}){return(t?[o,t]:[o]).map(r=>{let a=Ae({path:r,mainLoader:n,inlineLoader:i,data:e});return E(a).pipe(y(l=>({translation:l,lang:r})))})}function Le(n){let o={};function e(t,i){if(t===null)o[i]=null;else if(M(t))for(let[s,r]of Object.entries(t))e(r,i?`${i}.${s}`:s);else o[i]=t}return e(n,""),o}function Ke(n){let o={};for(let[e,t]of Object.entries(n)){let i=e.split("."),s=o;i.forEach((r,a)=>{a===i.length-1?s[r]=t:(s[r]??={},s=s[r])})}return o}function R(n){if(!n)return"";let o=n.split("/");return o.pop(),o.join("/")}function L(n){return n?n.split("/").pop():""}function He(n,o){return Object.keys(n).reduce((e,t)=>(e[`${o}/${t}`]=n[t],e),{})}function Oe(n){return typeof n?.scope=="string"}function Be(n){return n?.loader&&M(n.loader)}function z(n,o){return Be(n)?He(n.loader,o):void 0}function H(n){return{scope:R(n)||null,langName:L(n)}}var Ge;var we=(()=>{class n{loader;parser;missingHandler;interceptor;fallbackStrategy;langChanges$;translations=new Map;cache=new Map;firstFallbackLang;defaultLang="";availableLangs=[];isResolvedMissingOnce=!1;lang;failedLangs=new Set;events=new W;events$=this.events.asObservable();config;destroyRef=f(w);constructor(e,t,i,s,r,a){this.loader=e,this.parser=t,this.missingHandler=i,this.interceptor=s,this.fallbackStrategy=a,this.loader||(this.loader=new B(this.translations)),Ge=this,this.config=JSON.parse(JSON.stringify(r)),this.setAvailableLangs(this.config.availableLangs||[]),this.setFallbackLangForMissingTranslation(this.config),this.setDefaultLang(this.config.defaultLang),this.lang=new Y(this.getDefaultLang()),this.langChanges$=this.lang.asObservable(),this.events$.subscribe(l=>{l.type==="translationLoadSuccess"&&l.wasFailure&&this.setActiveLang(l.payload.langName)}),this.destroyRef.onDestroy(()=>{this.lang.complete(),this.events.complete(),this.cache.clear()})}getDefaultLang(){return this.defaultLang}setDefaultLang(e){this.defaultLang=e}getActiveLang(){return this.lang.getValue()}setActiveLang(e){return this.parser.onLangChanged?.(e),this.lang.next(e),this.events.next({type:"langChanged",payload:H(e)}),this}setAvailableLangs(e){this.availableLangs=e}getAvailableLangs(){return this.availableLangs}load(e,t={}){let i=this.cache.get(e);if(i)return i;let s,r=this._isLangScoped(e),a;r&&(a=R(e));let l={path:e,mainLoader:this.loader,inlineLoader:t.inlineLoader,data:r?{scope:a}:void 0};if(this.useFallbackTranslation(e)){let u=r?`${a}/${this.firstFallbackLang}`:this.firstFallbackLang,h=Ve(b(d({},l),{fallbackPath:u}));s=j(h)}else{let u=Ae(l);s=E(u)}let c=s.pipe(te(this.config.failedRetries),se(u=>{if(Array.isArray(u)){u.forEach(h=>{this.handleSuccess(h.lang,h.translation),h.lang!==e&&this.cache.set(h.lang,D({}))});return}this.handleSuccess(e,u)}),X(u=>(this.config.prodMode||console.error(`Error while trying to load "${e}"`,u),this.handleFailure(e,t))),ne(1),P(this.destroyRef));return this.cache.set(e,c),c}translate(e,t={},i=this.getActiveLang()){if(!e)return e;let{scope:s,resolveLang:r}=this.resolveLangAndScope(i);if(Array.isArray(e))return e.map(c=>this.translate(this.config.scopes.autoPrefixKeys&&s?`${s}.${c}`:c,t,r));e=this.config.scopes.autoPrefixKeys&&s?`${s}.${e}`:e;let a=this.getTranslation(r),l=a[e];return l?this.parser.transpile({value:l,params:t,translation:a,key:e}):this._handleMissingKey(e,l,t)}selectTranslate(e,t,i,s=!1){let r,a=(c,u)=>this.load(c,u).pipe(y(()=>s?this.translateObject(e,t,c):this.translate(e,t,c)));if(N(i))return this.langChanges$.pipe(S(c=>a(c)));if(i=Array.isArray(i)?i[0]:i,Oe(i)){let c=i;i=c.scope,r=z(c,c.scope)}if(i=i,this.isLang(i)||this.isScopeWithLang(i))return a(i);let l=i;return this.langChanges$.pipe(S(c=>a(`${l}/${c}`,{inlineLoader:r})))}isScopeWithLang(e){return this.isLang(L(e))}translateObject(e,t={},i=this.getActiveLang()){if(v(e)||Array.isArray(e)){let{resolveLang:r,scope:a}=this.resolveLangAndScope(i);if(Array.isArray(e))return e.map(u=>this.translateObject(this.config.scopes.autoPrefixKeys&&a?`${a}.${u}`:u,t,r));let l=this.getTranslation(r);e=this.config.scopes.autoPrefixKeys&&a?`${a}.${e}`:e;let c=Ke(this.getObjectByKey(l,e));return ve(c)?this.translate(e,t,i):this.parser.transpile({value:c,params:t,translation:l,key:e})}let s=[];for(let[r,a]of this.getEntries(e))s.push(this.translateObject(r,a,i));return s}selectTranslateObject(e,t,i){if(v(e)||Array.isArray(e))return this.selectTranslate(e,t,i,!0);let[[s,r],...a]=this.getEntries(e);return this.selectTranslateObject(s,r,i).pipe(y(l=>{let c=[l];for(let[u,h]of a)c.push(this.translateObject(u,h,i));return c}))}getTranslation(e){if(e){if(this.isLang(e))return this.translations.get(e)||{};{let{scope:t,resolveLang:i}=this.resolveLangAndScope(e),s=this.translations.get(i)||{};return this.getObjectByKey(s,t)}}return this.translations}selectTranslation(e){let t=this.langChanges$;if(e){let i=L(e)!==e;this.isLang(e)||i?t=D(e):t=this.langChanges$.pipe(y(s=>`${e}/${s}`))}return t.pipe(S(i=>this.load(i).pipe(y(()=>this.getTranslation(i)))))}setTranslation(e,t=this.getActiveLang(),i={}){let r=d(d({},{merge:!0,emitChange:!0}),i),a=R(t),l=e;if(a){let Ie=this.getMappedScope(a);l=Le({[Ie]:e})}let c=a?L(t):t,u=d(d({},r.merge&&this.getTranslation(c)),l),h=this.config.flatten.aot?u:Le(u),je=this.interceptor.preSaveTranslation(h,c);this.translations.set(c,je),r.emitChange&&this.setActiveLang(this.getActiveLang())}setTranslationKey(e,t,i={}){let s=i.lang||this.getActiveLang(),r=this.interceptor.preSaveTranslationKey(e,t,s),a={[e]:r};this.setTranslation(a,s,b(d({},i),{merge:!0}))}setFallbackLangForMissingTranslation({fallbackLang:e}){let t=Array.isArray(e)?e[0]:e;e&&this.useFallbackTranslation(t)&&(this.firstFallbackLang=t)}_handleMissingKey(e,t,i){if(this.config.missingHandler.allowEmpty&&t==="")return"";if(!this.isResolvedMissingOnce&&this.useFallbackTranslation()){this.isResolvedMissingOnce=!0;let s=this.translate(e,i,this.firstFallbackLang);return this.isResolvedMissingOnce=!1,s}return this.missingHandler.handle(e,this.getMissingHandlerData(),i)}_isLangScoped(e){return this.getAvailableLangsIds().indexOf(e)===-1}isLang(e){return this.getAvailableLangsIds().indexOf(e)!==-1}_loadDependencies(e,t){let i=L(e);return this._isLangScoped(e)&&!this.isLoadedTranslation(i)?Q([this.load(i),this.load(e,{inlineLoader:t})]):this.load(e,{inlineLoader:t})}_completeScopeWithLang(e){return this._isLangScoped(e)&&!this.isLang(L(e))?`${e}/${this.getActiveLang()}`:e}_setScopeAlias(e,t){this.config.scopeMapping||(this.config.scopeMapping={}),this.config.scopeMapping[e]=t}isLoadedTranslation(e){return _(this.getTranslation(e))}getAvailableLangsIds(){let e=this.getAvailableLangs()[0];return v(e)?this.getAvailableLangs():this.getAvailableLangs().map(t=>t.id)}getMissingHandlerData(){return b(d({},this.config),{activeLang:this.getActiveLang(),availableLangs:this.availableLangs,defaultLang:this.defaultLang})}useFallbackTranslation(e){return this.config.missingHandler.useFallbackTranslation&&e!==this.firstFallbackLang}handleSuccess(e,t){this.setTranslation(t,e,{emitChange:!1}),this.events.next({wasFailure:!!this.failedLangs.size,type:"translationLoadSuccess",payload:H(e)}),this.failedLangs.forEach(i=>this.cache.delete(i)),this.failedLangs.clear()}handleFailure(e,t){N(t.failedCounter)&&(t.failedCounter=0,t.fallbackLangs||(t.fallbackLangs=this.fallbackStrategy.getNextLangs(e)));let i=e.split("/"),r=t.fallbackLangs[t.failedCounter];if(this.failedLangs.add(e),this.cache.has(r))return this.handleSuccess(r,this.getTranslation(r)),Z;let a=r===i[i.length-1];if(!r||a){let c="Unable to load translation and all the fallback languages";throw i.length>1&&(c+=", did you misspelled the scope name?"),new Error(c)}let l=r;return i.length>1&&(i[i.length-1]=r,l=i.join("/")),t.failedCounter++,this.events.next({type:"translationLoadFailure",payload:H(e)}),this.load(l,t)}getMappedScope(e){let{scopeMapping:t={},scopes:i={keepCasing:!1}}=this.config;return t[e]||(i.keepCasing?e:V(e))}resolveLangAndScope(e){let t=e,i;if(this._isLangScoped(e)){let s=L(e),r=this.isLang(s);t=r?s:this.getActiveLang(),i=this.getMappedScope(r?R(e):e)}return{scope:i,resolveLang:t}}getObjectByKey(e,t){let i={},s=`${t}.`;for(let r in e)r.startsWith(s)&&(i[r.replace(s,"")]=e[r]);return i}getEntries(e){return e instanceof Map?e.entries():Object.entries(e)}static \u0275fac=function(t){return new(t||n)(p(me,8),p(be),p(ye),p(Se),p(O),p(Te))};static \u0275prov=T({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),qe=(()=>{class n{html;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=ue({type:n,selectors:[["ng-component"]],inputs:{html:"html"},decls:1,vars:1,consts:[[1,"transloco-loader-template",3,"innerHTML"]],template:function(t,i){t&1&&he(0,"div",0),t&2&&ge("innerHTML",i.html,ae)},encapsulation:2})}return n})(),G=class{view;vcr;constructor(o,e){this.view=o,this.vcr=e}attachView(){if(this.view instanceof $)this.vcr.createEmbeddedView(this.view);else if(v(this.view)){let o=this.vcr.createComponent(qe);o.instance.html=this.view,o.hostView.detectChanges()}else this.vcr.createComponent(this.view)}detachView(){this.vcr.clear()}},Ce=new g(""),ze=new g(""),Me=new g("");function q(n,o,e="|"){if(v(n)){let t=n.split(e),i=t.pop();return i===o?[!0,t.toString()]:[!1,i]}return[!1,""]}function Re(n,o){let[e]=q(o,"static");return e?!1:!!n.config.reRenderOnLangChange}function De(n){return n?o=>o:ee(1)}var x=class{initialized=!1;resolve({inline:o,provider:e,active:t}){let i=t;if(this.initialized)return i=t,i;if(e){let[,s]=q(e,"static");i=s}if(o){let[,s]=q(o,"static");i=s}return this.initialized=!0,i}resolveLangBasedOnScope(o){return R(o)?L(o):o}resolveLangPath(o,e){return e?`${e}/${o}`:o}},F=class{service;constructor(o){this.service=o}resolve(o){let{inline:e,provider:t}=o;if(e)return e;if(t){if(Oe(t)){let{scope:i,alias:s=this.service.config.scopes.keepCasing?i:V(i)}=t;return this.service._setScopeAlias(i,s),i}return t}}},Ft=(()=>{class n{destroyRef=f(w);service=f(we);tpl=f($,{optional:!0});providerLang=f(Ce,{optional:!0});providerScope=f(Me,{optional:!0});providedLoadingTpl=f(ze,{optional:!0});cdr=f(I);host=f(oe);vcr=f(le);renderer=f(ce);view;memo=new Map;key;params={};inlineScope;inlineRead;prefix;inlineLang;inlineTpl;currentLang;loaderTplHandler;initialized=!1;path;langResolver=new x;scopeResolver=new F(this.service);strategy=this.tpl===null?"attribute":"structural";static ngTemplateContextGuard(e,t){return!0}ngOnInit(){let e=Re(this.service,this.providerLang||this.inlineLang);if(this.service.langChanges$.pipe(S(t=>{let i=this.langResolver.resolve({inline:this.inlineLang,provider:this.providerLang,active:t});return Array.isArray(this.providerScope)?j(this.providerScope.map(s=>this.resolveScope(i,s))):this.resolveScope(i,this.providerScope)}),De(e),P(this.destroyRef)).subscribe(()=>{this.currentLang=this.langResolver.resolveLangBasedOnScope(this.path),this.strategy==="attribute"?this.attributeStrategy():this.structuralStrategy(this.currentLang,this.prefix||this.inlineRead),this.cdr.markForCheck(),this.initialized=!0}),!this.initialized){let t=this.resolveLoadingContent();t&&(this.loaderTplHandler=new G(t,this.vcr),this.loaderTplHandler.attachView())}}ngOnChanges(e){this.strategy==="attribute"&&Object.keys(e).some(i=>!e[i].firstChange)&&this.attributeStrategy()}attributeStrategy(){this.detachLoader(),this.renderer.setProperty(this.host.nativeElement,"innerText",this.service.translate(this.key,this.params,this.currentLang))}structuralStrategy(e,t){this.memo.clear();let i=this.getTranslateFn(e,t);this.view?(this.view.context.$implicit=i,this.view.context.currentLang=this.currentLang):(this.detachLoader(),this.view=this.vcr.createEmbeddedView(this.tpl,{$implicit:i,currentLang:this.currentLang}))}getTranslateFn(e,t){return(i,s)=>{let r=t?`${t}.${i}`:i,a=s?`${r}${JSON.stringify(s)}`:r;return this.memo.has(a)||this.memo.set(a,this.service.translate(r,s,e)),this.memo.get(a)}}resolveLoadingContent(){return this.inlineTpl||this.providedLoadingTpl}ngOnDestroy(){this.memo.clear()}detachLoader(){this.loaderTplHandler?.detachView()}resolveScope(e,t){let i=this.scopeResolver.resolve({inline:this.inlineScope,provider:t});this.path=this.langResolver.resolveLangPath(e,i);let s=z(t,i);return this.service._loadDependencies(this.path,s)}static \u0275fac=function(t){return new(t||n)};static \u0275dir=de({type:n,selectors:[["","transloco",""]],inputs:{key:[0,"transloco","key"],params:[0,"translocoParams","params"],inlineScope:[0,"translocoScope","inlineScope"],inlineRead:[0,"translocoRead","inlineRead"],prefix:[0,"translocoPrefix","prefix"],inlineLang:[0,"translocoLang","inlineLang"],inlineTpl:[0,"translocoLoadingTpl","inlineTpl"]},features:[re]})}return n})(),Et=(()=>{class n{service;providerScope;providerLang;cdr;subscription=null;lastValue="";lastKey;path;langResolver=new x;scopeResolver;constructor(e,t,i,s){this.service=e,this.providerScope=t,this.providerLang=i,this.cdr=s,this.scopeResolver=new F(this.service)}transform(e,t,i){if(!e)return e;let s=t?`${e}${JSON.stringify(t)}`:e;if(s===this.lastKey)return this.lastValue;this.lastKey=s,this.subscription?.unsubscribe();let r=Re(this.service,this.providerLang||i);return this.subscription=this.service.langChanges$.pipe(S(a=>{let l=this.langResolver.resolve({inline:i,provider:this.providerLang,active:a});return Array.isArray(this.providerScope)?j(this.providerScope.map(c=>this.resolveScope(l,c))):this.resolveScope(l,this.providerScope)}),De(r)).subscribe(()=>this.updateValue(e,t)),this.lastValue}ngOnDestroy(){this.subscription?.unsubscribe(),this.subscription=null}updateValue(e,t){let i=this.langResolver.resolveLangBasedOnScope(this.path);this.lastValue=this.service.translate(e,t,i),this.cdr.markForCheck()}resolveScope(e,t){let i=this.scopeResolver.resolve({inline:void 0,provider:t});this.path=this.langResolver.resolveLangPath(e,i);let s=z(t,i);return this.service._loadDependencies(this.path,s)}static \u0275fac=function(t){return new(t||n)(C(we,16),C(Me,24),C(Ce,24),C(I,16))};static \u0275pipe=fe({name:"transloco",type:n,pure:!1})}return n})();function $t(n){let o=[We(Ee),Ze(Pe),Qe(ke),Ye(_e)];return n.config&&o.push(Ue(n.config)),n.loader&&o.push(Je(n.loader)),o}function Ue(n){return m([{provide:O,useValue:xe(n)}])}function Je(n){return m([{provide:me,useClass:n}])}function We(n){return m([{provide:be,useClass:n,deps:[O]}])}function Ye(n){return m([{provide:Te,useClass:n,deps:[O]}])}function Ze(n){return m([{provide:ye,useClass:n}])}function Qe(n){return m([{provide:Se,useClass:n}])}export{Ft as a,Et as b,$t as c};
